# Kickstart file automatically generated by anaconda.

#version=DEVEL
install
cdrom
lang en_US.UTF-8
keyboard es
network --onboot yes --device eth0 --bootproto static --noipv6
network --onboot no --device eth1 --bootproto dhcp --noipv6
rootpw  --iscrypted xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
firewall --service=ssh
authconfig --enableshadow --passalgo=sha512
selinux --permissive
timezone --utc Europe/Madrid
bootloader --location=mbr --driveorder=sda,sdb --append="crashkernel=auto rhgb quiet"
# The following is the partition information you requested
# Note that any partitions you deleted are not expressed
# here so unless you clear all partitions first, this is
# not guaranteed to work
zerombr
clearpart --all --drives=sda,sdb

part raid.008001 --asprimary --ondrive=sda --size=500
part raid.008002 --asprimary --ondrive=sda --size=98304
part raid.008003 --asprimary --ondrive=sda --size=100000
part raid.008005 --asprimary --ondrive=sda --grow --size=755060

part raid.008011 --asprimary --ondrive=sdb --size=500
part raid.008012 --asprimary --ondrive=sdb --size=98304
part raid.008013 --asprimary --ondrive=sdb --size=100000
part raid.008015 --asprimary --ondrive=sdb --grow --size=755060

raid /boot --fstype=ext4 --level=1 --device=md0 raid.008001 raid.008011
raid / --fstype=ext4 --level=1 --device=md1 raid.008003 raid.008013
raid /var --fstype=ext4 --level=1 --device=md2 raid.008005 raid.008015
raid swap --level=1 --device=md3 raid.008002 raid.008012

%packages
@base
@client-mgmt-tools
@console-internet
@core
@debugging
@directory-client
@hardware-monitoring
@java-platform
@large-systems
@network-file-system-client
@performance
@perl-runtime
@server-platform
@server-policy
pax
python-dmidecode
oddjob
sgpio
certmonger
pam_krb5
krb5-workstation
perl-DBD-SQLite
ntp
xorg-x11-xauth 
xorg-x11-xinit 
xorg-x11-apps 
%end

#%pre
#pre-installation scripts
#%end



%post --log=/root/ks-post.log

#/bin/bash
echo "Configuring services"
echo "Disable iptables"
/sbin/chkconfig iptables off
echo "Enable ntpd"
/sbin/chkconfig ntpd on
#
echo "Adding users"
/usr/sbin/useradd user1
/usr/bin/chfn -f "user1" user1
/usr/sbin/usermod -p 'XXXXXXXXXXXXXXXXXXXXXXXXX' user1



#
echo "Configuring YUM"
echo "proxy=http://X.X.X.X:PPPP" >> /etc/yum.conf

echo "Setting DNS"
echo DNS1=D.D.D.D >> /etc/sysconfig/network-scripts/ifcfg-eth0
echo DNS2=D.D.D.D >> /etc/sysconfig/network-scripts/ifcfg-eth0
echo DOMAIN=enterprise.com >> /etc/sysconfig/network-scripts/ifcfg-eth0

#echo "Configuring hostname"
IP=`ip addr show eth0 | grep "inet " | awk '{print $2}'| cut -d'/' -f1 `
HOSTNAME=`nslookup $IP | grep name| awk '{print $4}' |sed 's/.$//'`
sed -i -e 's#^\(HOSTNAME=\).*$#\1'"$HOSTNAME"'#' /etc/sysconfig/network

%end
